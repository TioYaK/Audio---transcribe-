<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Careca.ai</title>
    <link rel="icon"
        href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22>üéôÔ∏è</text></svg>">
    <!-- Use Phosphor Icons for that futuristic look -->
    <script src="https://cdn.jsdelivr.net/npm/@phosphor-icons/web"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="stylesheet" href="/static/style.css?v=2">
</head>

<body>
    <div class="app-container">
        <!-- Sidebar -->
        <aside class="sidebar">
            <div class="logo-area">
                <i class="ph-fill ph-wave-sine" style="font-size: 1.5rem;"></i>
                <span>Careca.ai</span>
            </div>

            <button class="sidebar-toggle" id="sidebar-toggle" title="Colapsar sidebar">
                <i class="ph ph-caret-left"></i>
            </button>

            <nav class="nav-links">
                <a href="#" class="nav-item active" id="dashboard-link">
                    <i class="ph ph-squares-four"></i>
                    <span>Dashboard</span>
                </a>
                </a>
                <a href="#" class="nav-item" id="report-link">
                    <i class="ph ph-chart-pie-slice"></i>
                    <span>Relat√≥rios</span>
                </a>
                <a href="#" class="nav-item" id="join-qld-link">
                    <i class="ph ph-files"></i>
                    <span>Juntar (QLD)</span>
                </a>
                <a href="#" class="nav-item" id="join-cap-link">
                    <i class="ph ph-files"></i>
                    <span>Juntar (CAP)</span>
                </a>
                <a href="#" class="nav-item hidden" id="admin-link">
                    <i class="ph ph-shield-check"></i>
                    <span>Admin</span>
                </a>
                <a href="#" class="nav-item hidden" id="terminal-link">
                    <i class="ph ph-terminal-window"></i>
                    <span>Terminal</span>
                </a>
                <a href="#" class="nav-item" id="export-link">
                    <i class="ph ph-export"></i>
                    <span>Exportar</span>
                </a>
            </nav>

            <div class="nav-footer">
                <div class="theme-toggle" id="theme-toggle">
                    <i class="ph ph-sun" id="theme-icon"></i>
                    <span class="toggle-label">Modo Claro</span>
                </div>
                <div class="theme-toggle" id="logout-btn" style="margin-top: 8px; cursor: pointer;">
                    <i class="ph ph-sign-out"></i>
                    <span>Sair</span>
                </div>
            </div>
        </aside>

        <!-- Main Content -->
        <main class="main-content">
            <!-- DASHBOARD VIEW -->
            <div id="dashboard-view">
                <div class="header-bar">
                    <div class="page-title">
                        <!-- Removed Title/Desc as requested -->
                    </div>
                    <div id="user-limit-badge"
                        style="display: flex; align-items: center; gap: 8px; padding: 8px 16px; background: var(--bg-card); border: 1px solid var(--border); border-radius: 12px;">
                        <i class="ph ph-chart-bar" style="font-size: 1.2rem; color: var(--primary);"></i>
                        <div style="display: flex; flex-direction: column; gap: 2px;">
                            <span
                                style="font-size: 0.75rem; color: var(--text-muted); text-transform: uppercase; letter-spacing: 0.5px;">Transcri√ß√µes</span>
                            <span id="usage-display" style="font-weight: 600; font-size: 1rem; color: var(--text);">- /
                                -</span>
                        </div>
                    </div>
                </div>

                <!-- Upload Area -->
                <div class="upload-container" id="upload-zone">
                    <input type="file" id="file-input" multiple hidden accept="audio/*,video/*">
                    <div class="upload-icon-wrapper">
                        <i class="ph ph-cloud-arrow-up"></i>
                    </div>
                    <h3 style="margin-bottom:8px; font-weight:600">Arraste seus arquivos</h3>
                    <p style="color:var(--text-muted); margin-bottom:24px">ou clique para selecionar</p>
                    <div
                        style="margin-bottom: 24px; display: flex; gap: 16px; justify-content: center; flex-wrap: wrap;">
                        <label
                            style="display: flex; align-items: center; gap: 6px; cursor: pointer; color: var(--text-muted); font-size: 0.9rem;">
                            <input type="checkbox" id="opt-timestamp" style="accent-color: var(--primary);">
                            Timestamps
                        </label>
                    </div>
                    <button class="btn-primary btn-upload-trigger">
                        <i class="ph-bold ph-upload-simple"></i>
                        Selecionar Arquivos
                    </button>
                </div>

                <!-- Status Section -->
                <!-- Status Section -->
                <div id="status-section" class="status-list hidden" style="margin-bottom:32px">
                    <h3 style="margin-bottom:16px; font-size:1.1rem">Em Processamento</h3>
                    <div id="inprogress-list"></div>
                </div>

                <!-- History Section -->
                <div class="glass-card">
                    <div class="section-header"
                        style="display:flex; justify-content:space-between; align-items:center; margin-bottom:16px">
                        <div style="display:flex; align-items:center; gap:8px">
                            <i class="ph-fill ph-clock-counter-clockwise"
                                style="color:var(--primary); font-size:1.2rem"></i>
                            <h3 style="margin:0">Hist√≥rico</h3>
                        </div>
                        <button class="action-btn" id="btn-clear-history" title="Limpar Hist√≥rico"><i
                                class="ph ph-trash"></i></button>
                    </div>

                    <div id="empty-state" class="empty-state hidden">
                        <div class="empty-icon"><i class="ph ph-files"></i></div>
                        <p>Nenhuma transcri√ß√£o encontrada</p>
                    </div>

                    <table id="history-table" style="width:100%; border-collapse:collapse; margin-top:16px">
                        <thead>
                            <tr
                                style="text-align:left; color:var(--text-muted); font-size:0.85rem; border-bottom:1px solid var(--border)">
                                <th style="padding:12px; font-weight:500">Arquivo</th>
                                <th style="padding:12px; font-weight:500">Data</th>
                                <th style="padding:12px; font-weight:500; cursor:pointer; user-select:none"
                                    onclick="toggleSort('duration')">
                                    Dura√ß√£o
                                    <i id="sort-duration-icon" class="ph-bold ph-arrows-down-up"
                                        style="font-size:0.9em; vertical-align:middle; margin-left:4px"></i>
                                </th>
                                <th style="padding:12px; font-weight:500">Status</th>
                                <th style="padding:12px; font-weight:500">A√ß√µes</th>
                            </tr>
                        </thead>
                        <tbody id="history-body">
                            <!-- JS renders rows -->
                        </tbody>
                    </table>
                </div>

                <!-- Result Modal -->
                <div class="modal-overlay" id="result-modal">
                    <div class="modal-content">
                        <div class="modal-header">
                            <!-- Removed 'Detalhes da Transcri√ß√£o' -->
                            <button class="action-btn" id="btn-close-modal" style="margin-left:auto;"><i class="ph ph-x"
                                    style="font-size:1.2rem;"></i></button>
                        </div>
                        <div id="result-meta" style="margin-bottom:16px; color:var(--text-muted); font-size:0.9rem;">
                        </div>

                        <!-- Custom Audio Player -->
                        <div class="audio-player-container hidden" id="audio-player">
                            <audio id="audio-element" preload="none"></audio>

                            <button class="player-btn" id="play-pause-btn">
                                <i class="ph-fill ph-play" id="play-icon"></i>
                            </button>

                            <span id="current-time" class="time-display">0:00</span>

                            <div class="seek-bar-container" id="seek-container">
                                <div class="seek-bar-fill" id="seek-fill"></div>
                            </div>

                            <span id="duration-display" class="time-display">0:00</span>

                            <div class="volume-container">
                                <i class="ph ph-speaker-high" id="volume-icon"></i>
                                <div class="volume-slider-wrapper">
                                    <input type="range" class="volume-slider" id="volume-slider" min="0" max="1"
                                        step="0.1" value="1">
                                </div>
                            </div>
                        </div>

                        <div class="tabs" style="margin-top:10px;">
                            <button class="tab-btn active" onclick="switchResultTab('text', this)">Transcri√ß√£o</button>
                            <button class="tab-btn" onclick="switchResultTab('summary', this)">Resumo IA üß†</button>
                            <button class="tab-btn" onclick="switchResultTab('topics', this)">T√≥picos üè∑Ô∏è</button>
                        </div>

                        <div id="tab-content-text" class="tab-content active">
                            <textarea id="result-text" class="result-textarea" readonly></textarea>
                        </div>
                        <div id="tab-content-summary" class="tab-content">
                            <div id="result-summary" class="ai-content">
                                <p style="color:var(--text-muted)">Gerando an√°lise...</p>
                            </div>
                        </div>
                        <div id="tab-content-topics" class="tab-content">
                            <div id="result-topics" class="ai-content">
                                <p style="color:var(--text-muted)">Extraindo t√≥picos...</p>
                            </div>
                        </div>

                        <div style="display:flex; justify-content:flex-end; gap:12px;">
                            <button class="action-btn" id="btn-copy-text" style="border:1px solid var(--border);">
                                <i class="ph ph-copy"></i> Copiar
                            </button>
                            <button class="action-btn" id="btn-download-audio" style="border:1px solid var(--border);">
                                <i class="ph ph-file-audio"></i> Baixar √Åudio
                            </button>
                            <button class="btn-upload-trigger" id="btn-download-text"
                                style="margin:0; font-size:0.9rem;">
                                Baixar Transcri√ß√£o
                            </button>
                        </div>
                    </div>
                </div>
            </div>

            <!-- REPORTS VIEW -->
            <div id="report-view" class="hidden">
                <div class="header-bar">
                    <div class="page-title">
                        <h1>Relat√≥rios</h1>
                        <p>Estat√≠sticas de performance</p>
                    </div>
                </div>
                <div class="stats-grid">
                    <div class="stat-card">
                        <h3>Total</h3>
                        <p id="stat-total">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Procedente</h3>
                        <p id="stat-proced">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Improcedente</h3>
                        <p id="stat-improced">0</p>
                    </div>
                    <div class="stat-card">
                        <h3>Pendente</h3>
                        <p id="stat-pending">0</p>
                    </div>
                </div>
                <div class="glass-card" style="margin-top:24px; padding:24px; height:400px">
                    <canvas id="reportsChart"></canvas>
                </div>
            </div>

            <!-- ADMIN VIEW -->
            <div id="admin-view" class="hidden">
                <!-- JS Populates this -->
            </div>

            <!-- TERMINAL VIEW -->
            <div id="terminal-view" class="hidden">
                <div class="header-bar">
                    <div class="page-title">
                        <h1>Terminal do Servidor</h1>
                    </div>
                    <div style="display:flex; align-items:center; gap:16px;">
                        <button class="action-btn delete" onclick="adminClearCache()"
                            style="border:1px solid var(--danger); background: var(--bg-card); color: var(--danger); font-size:0.8rem; padding: 6px 12px;">
                            <i class="ph ph-trash"></i> Limpar Banco/Cache
                        </button>
                        <div style="font-size:0.8rem; color:var(--text-muted)">Auto-refresh (2s)</div>
                    </div>
                </div>
                <div id="terminal-output"
                    style="background:#0f172a; color:#10b981; padding:16px; border-radius:8px; font-family:monospace; height:600px; overflow-y:auto; white-space:pre-wrap; border:1px solid var(--border); font-size:0.85rem">
                    Carregando logs...
                </div>
            </div>
    </div>

    <script src="/static/script.js?v=13"></script>
</body>

</html>